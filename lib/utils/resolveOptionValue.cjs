// NOTICE: This file is generated by Rollup. To modify it,
// please instead edit the ESM counterpart and rebuild with Rollup (npm run build).
'use strict';

const getConfigForFile = require('../getConfigForFile.cjs');

/** @import {InternalApi, LinterOptions, Config, CosmiconfigResult} from 'stylelint' */

/**
 * Get a value of the specified lint option or configuration.
 *
 * @template T
 * @typedef {object} ResolveOptionValueOptions
 * @property {InternalApi} stylelint
 * @property {keyof LinterOptions & keyof Config} name
 * @property {T} [default]
 */

/**
 * @template T
 * @param {ResolveOptionValueOptions<T>} options
 * @param {CosmiconfigResult} [config]
 * @returns {Promise<T>}
 */
async function resolveOptionValue(
	{ stylelint, name, default: defaultValue = undefined },
	config,
) {
	const options = stylelint._options;
	const value = options[name] ?? options.config?.[name];

	if (value != null) {
		return /** @type {T} */ (value);
	}

	const configForFile = config
		? config
		: await getConfigForFile({ stylelint, failIfNoConfig: false });

	return configForFile?.config?.[name] ?? defaultValue;
}

module.exports = resolveOptionValue;
